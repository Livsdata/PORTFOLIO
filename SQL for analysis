-- 1. Total Sales Revenue by Month
SELECT
    strftime('%Y-%m', order_date) AS sales_month, -- For SQLite. Use DATE_FORMAT(order_date, '%Y-%m') for MySQL, FORMAT(order_date, 'yyyy-MM') for SQL Server, TO_CHAR(order_date, 'YYYY-MM') for PostgreSQL
    SUM(total_amount) AS total_revenue
FROM Orders
GROUP BY sales_month
ORDER BY sales_month;

-- 2. Top 5 Best-Selling Products by Quantity
SELECT
    p.product_name,
    SUM(oi.quantity) AS total_quantity_sold
FROM Order_Items oi
JOIN Products p ON oi.product_id = p.product_id
GROUP BY p.product_name
ORDER BY total_quantity_sold DESC
LIMIT 5;

-- 3. Total Orders and Revenue by Customer Region
SELECT
    c.region,
    COUNT(o.order_id) AS total_orders,
    SUM(o.total_amount) AS total_revenue_by_region
FROM Orders o
JOIN Customers c ON o.customer_id = c.customer_id
GROUP BY c.region
ORDER BY total_revenue_by_region DESC;

-- 4. Average Order Value
SELECT
    AVG(total_amount) AS average_order_value
FROM Orders;

-- 5. Products that have never been ordered
SELECT
    p.product_name,
    p.category
FROM Products p
LEFT JOIN Order_Items oi ON p.product_id = oi.product_id
WHERE oi.order_item_id IS NULL;
